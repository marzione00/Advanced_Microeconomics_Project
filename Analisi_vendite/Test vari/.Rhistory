#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[30:48]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[31:48]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Elettrodomestici = ts(Destagionalizzazione$Elettrodomestici,frequency = 12)
TS_Elettrodomestici_dec<-decompose(TS_Elettrodomestici,type="additive")
#TS_Elettrodomestici_dec$trend[30:48]=TS_Elettrodomestici_dec$trend[30:48]+TS_Elettrodomestici_dec$random[30:48]
TS_Elettrodomestici_dec$random[30:48]=0
TS_Elettrodomestici_dec$trend=TS_Elettrodomestici_dec$x-TS_Elettrodomestici_dec$random-TS_Elettrodomestici_dec$seasonal
autoplot(TS_Elettrodomestici_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Elettrodomestici_dec)
TS_Fotoottica = ts(Destagionalizzazione$Fotoottica,frequency = 12)
TS_Fotoottica_dec<-decompose(TS_Fotoottica,type="additive")
#TS_Fotoottica_dec$trend[30:48]=TS_Fotoottica_dec$trend[30:48]+TS_Fotoottica_dec$random[30:48]
TS_Fotoottica_dec$random[30:48]=0
TS_Fotoottica_dec$trend=TS_Fotoottica_dec$x-TS_Fotoottica_dec$random-TS_Fotoottica_dec$seasonal
autoplot(TS_Fotoottica_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Fotoottica_dec)
TS_Casalinghi = ts(Destagionalizzazione$Casalinghi,frequency = 12)
TS_Casalinghi_dec<-decompose(TS_Casalinghi,type="additive")
TS_Casalinghi_dec$trend[30:48]=TS_Casalinghi_dec$trend[30:48]+TS_Casalinghi_dec$random[30:48]
TS_Casalinghi_dec$random[30:48]=0
TS_Casalinghi_dec$trend=TS_Casalinghi_dec$x-TS_Casalinghi_dec$random-TS_Casalinghi_dec$seasonal
autoplot(TS_Casalinghi_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Casalinghi_dec)
TS_Utilenseria = ts(Destagionalizzazione$Utilenseria,frequency = 12)
TS_Utilenseria_dec<-decompose(TS_Utilenseria,type="additive")
TS_Utilenseria_dec$trend[30:48]=TS_Utilenseria_dec$trend[30:48]+TS_Utilenseria_dec$random[30:48]
TS_Utilenseria_dec$random[30:48]=0
TS_Utilenseria_dec$trend=TS_Utilenseria_dec$x-TS_Utilenseria_dec$random-TS_Utilenseria_dec$seasonal
autoplot(TS_Utilenseria_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Utilenseria_dec)
TS_Giocattoli = ts(Destagionalizzazione$Giocattoli,frequency = 12)
TS_Giocattoli_dec<-decompose(TS_Giocattoli,type="additive")
TS_Giocattoli_dec$random[30:48]=0
TS_Giocattoli_dec$trend=TS_Giocattoli_dec$x-TS_Giocattoli_dec$random-TS_Giocattoli_dec$seasonal
autoplot(TS_Giocattoli_dec)
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
TS_Alimentare_dec<-decompose(TS_Alimentare,type="additive")
TS_Alimentare_dec$random[1:48]=0
TS_Alimentare_dec$trend=TS_Alimentare_dec$x-TS_Alimentare_dec$random-TS_Alimentare_dec$seasonal
autoplot(TS_Alimentare_dec)+theme(legend.title=element_blank())
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
TS_Alimentare_dec<-decompose(TS_Alimentare,type="additive")
TS_Alimentare_dec$random[1:48]=0
TS_Alimentare_dec$trend=TS_Alimentare_dec$x-TS_Alimentare_dec$random-TS_Alimentare_dec$seasonal
autoplot(TS_Alimentare_dec)+labs(colour = NULL)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
Controllo_abbigliamento<-lm(Data$Abbigliamento[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_abbigliamento)
Controllo_calzature<-lm(Data$Calzature[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_calzature)
Controllo_Elettrodomestici<-lm(Data$Elettrodomestici[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Elettrodomestici)
Controllo_Fotootica<-lm(Data$Fotoottica[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Fotootica)
Controllo_Casalinghi<-lm(Data$Casalinghi[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Casalinghi)
Controllo_Utilenseria<-lm(Data$Utilenseria[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Utilenseria)
Controllo_Giocattoli<-lm(Data$Giocattoli[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Giocattoli)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
reg2<-lm(Data$Abbigliamento-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg2)
reg3<-lm(Data$Calzature-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg3)
reg4<-lm(Data$Elettrodomestici-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg4)
reg5<-lm(Data$Mobili-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg5)
reg6<-lm(Data$Fotoottica-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg6)
reg7<-lm(Data$Casalinghi-Data$Alimentari~Data$T1+Data$T2+Data$T3)
summary(reg7)
reg8<-lm(Data$Utilenseria-Data$Alimentari~Data$T1+Data$T2+Data$T3)
summary(reg8)
reg7<-lm(Data$Casalinghi-Data$Alimentari~Data$T1+Data$T2+Data$T3)
summary(reg7)
reg6<-lm(Data$Fotoottica-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg6)
reg4<-lm(Data$Elettrodomestici-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg4)
reg3<-lm(Data$Calzature-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg3)
reg2<-lm(Data$Abbigliamento-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg2)
Controllo_calzature<-lm(Data$Calzature[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_calzature)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
reg10<-lm(Data$Giocattoli-Data$Alimentari~Data$T1+Data$T2+Data$T3)
summary(reg10)
Controllo_Giocattoli<-lm(Data$Giocattoli[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_Giocattoli)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
library(readxl)
library(xlsx)
library(fpp)
library(ggplot2)
library(zoo)
ggplot(data=Produzione,aes(x=Data,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Data,y=Legno_carta),color = "blue")+geom_line(size=2,aes(x=Data,y=Gomma),color = "green")+geom_line(size=2,aes(x=Data,y=Computer),color = "orange")+geom_line(size=2,aes(x=Data,y=ElettronicaM),color = "purple")+geom_line(size=2,aes(x=Data,y=Calzature),color = "darkgreen")+geom_line(size=2,aes(x=Data,y=Farmaceutici),color = "black")+ylim(0, 150)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
TS_Alimentare_dec<-decompose(TS_Alimentare,type="additive")
TS_Alimentare_dec$random[1:48]=0
TS_Alimentare_dec$trend=TS_Alimentare_dec$x-TS_Alimentare_dec$random-TS_Alimentare_dec$seasonal
autoplot(TS_Alimentare_dec)+labs(colour = NULL)
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[30:48]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
autoplot(log10(TS_Abbigliamento_dec$trend))+ geom_line(aes(y=log10(TS_Alimentare_dec$trend)))
autoplot(TS_Abbigliamento_dec)
autoplot(TS_Calzature_dec)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[31:48]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Elettrodomestici = ts(Destagionalizzazione$Elettrodomestici,frequency = 12)
TS_Elettrodomestici_dec<-decompose(TS_Elettrodomestici,type="additive")
#TS_Elettrodomestici_dec$trend[30:48]=TS_Elettrodomestici_dec$trend[30:48]+TS_Elettrodomestici_dec$random[30:48]
TS_Elettrodomestici_dec$random[30:48]=0
TS_Elettrodomestici_dec$trend=TS_Elettrodomestici_dec$x-TS_Elettrodomestici_dec$random-TS_Elettrodomestici_dec$seasonal
autoplot(TS_Elettrodomestici_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Elettrodomestici_dec)
TS_Casalinghi = ts(Destagionalizzazione$Casalinghi,frequency = 12)
TS_Casalinghi_dec<-decompose(TS_Casalinghi,type="additive")
TS_Casalinghi_dec$trend[30:48]=TS_Casalinghi_dec$trend[30:48]+TS_Casalinghi_dec$random[30:48]
TS_Casalinghi_dec$random[30:48]=0
TS_Casalinghi_dec$trend=TS_Casalinghi_dec$x-TS_Casalinghi_dec$random-TS_Casalinghi_dec$seasonal
autoplot(TS_Casalinghi_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Casalinghi_dec)
autoplot(log10(TS_Casalinghi_dec$trend))+ geom_line(aes(y=log10(TS_Alimentare_dec$trend)))+xlim(1,4.6)
TS_Utilenseria = ts(Destagionalizzazione$Utilenseria,frequency = 12)
TS_Utilenseria_dec<-decompose(TS_Utilenseria,type="additive")
TS_Utilenseria_dec$trend[30:48]=TS_Utilenseria_dec$trend[30:48]+TS_Utilenseria_dec$random[30:48]
TS_Utilenseria_dec$random[30:48]=0
TS_Utilenseria_dec$trend=TS_Utilenseria_dec$x-TS_Utilenseria_dec$random-TS_Utilenseria_dec$seasonal
autoplot(TS_Utilenseria_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Utilenseria_dec)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
TS_Alimentare_dec<-decompose(TS_Alimentare,type="additive")
autoplot(TS_Alimentare_dec)+labs(colour = NULL)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
TS_Alimentare = ts(Destagionalizzazione$alimentare,frequency = 12)
TS_Alimentare_dec<-decompose(TS_Alimentare,type="additive")
TS_Alimentare_dec$random[1:60]=0
TS_Alimentare_dec$trend=TS_Alimentare_dec$x-TS_Alimentare_dec$random-TS_Alimentare_dec$seasonal
autoplot(TS_Alimentare_dec)+labs(colour = NULL)
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
autoplot(TS_Abbigliamento_dec)
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[32:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Elettrodomestici = ts(Destagionalizzazione$Elettrodomestici,frequency = 12)
TS_Elettrodomestici_dec<-decompose(TS_Elettrodomestici,type="additive")
#TS_Elettrodomestici_dec$trend[30:48]=TS_Elettrodomestici_dec$trend[30:48]+TS_Elettrodomestici_dec$random[30:48]
TS_Elettrodomestici_dec$random[42:60]=0
TS_Elettrodomestici_dec$trend=TS_Elettrodomestici_dec$x-TS_Elettrodomestici_dec$random-TS_Elettrodomestici_dec$seasonal
autoplot(TS_Elettrodomestici_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Elettrodomestici_dec)
TS_Mobili = ts(Destagionalizzazione$Mobili,frequency = 12)
TS_Mobili_dec<-decompose(TS_Mobili,type="additive")
#TS_Mobili_dec$trend[30:48]=TS_Mobili_dec$trend[30:48]+TS_Mobili_dec$random[30:48]
TS_Mobili_dec$random[42:60]=0
TS_Mobili_dec$trend=TS_Mobili_dec$x-TS_Mobili_dec$random-TS_Mobili_dec$seasonal
autoplot(TS_Mobili_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Mobili_dec)
TS_Fotoottica = ts(Destagionalizzazione$Fotoottica,frequency = 12)
TS_Fotoottica_dec<-decompose(TS_Fotoottica,type="additive")
#TS_Fotoottica_dec$trend[30:48]=TS_Fotoottica_dec$trend[30:48]+TS_Fotoottica_dec$random[30:48]
TS_Fotoottica_dec$random[42:60]=0
TS_Fotoottica_dec$trend=TS_Fotoottica_dec$x-TS_Fotoottica_dec$random-TS_Fotoottica_dec$seasonal
autoplot(TS_Fotoottica_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Fotoottica_dec)
TS_Casalinghi = ts(Destagionalizzazione$Casalinghi,frequency = 12)
TS_Casalinghi_dec<-decompose(TS_Casalinghi,type="additive")
TS_Casalinghi_dec$trend[30:48]=TS_Casalinghi_dec$trend[30:48]+TS_Casalinghi_dec$random[30:48]
TS_Casalinghi_dec$random[30:48]=0
TS_Casalinghi_dec$trend=TS_Casalinghi_dec$x-TS_Casalinghi_dec$random-TS_Casalinghi_dec$seasonal
autoplot(TS_Casalinghi_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Casalinghi_dec)
TS_Casalinghi = ts(Destagionalizzazione$Casalinghi,frequency = 12)
TS_Casalinghi_dec<-decompose(TS_Casalinghi,type="additive")
TS_Casalinghi_dec$trend[30:48]=TS_Casalinghi_dec$trend[30:48]+TS_Casalinghi_dec$random[30:48]
TS_Casalinghi_dec$random[42:60]=0
TS_Casalinghi_dec$trend=TS_Casalinghi_dec$x-TS_Casalinghi_dec$random-TS_Casalinghi_dec$seasonal
autoplot(TS_Casalinghi_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Casalinghi_dec)
TS_Utilenseria = ts(Destagionalizzazione$Utilenseria,frequency = 12)
TS_Utilenseria_dec<-decompose(TS_Utilenseria,type="additive")
TS_Utilenseria_dec$trend[30:48]=TS_Utilenseria_dec$trend[30:48]+TS_Utilenseria_dec$random[30:48]
TS_Utilenseria_dec$random[42:60]=0
TS_Utilenseria_dec$trend=TS_Utilenseria_dec$x-TS_Utilenseria_dec$random-TS_Utilenseria_dec$seasonal
autoplot(TS_Utilenseria_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Utilenseria_dec)
TS_Giocattoli = ts(Destagionalizzazione$Giocattoli,frequency = 12)
TS_Giocattoli_dec<-decompose(TS_Giocattoli,type="additive")
TS_Giocattoli_dec$random[42:60]=0
TS_Giocattoli_dec$trend=TS_Giocattoli_dec$x-TS_Giocattoli_dec$random-TS_Giocattoli_dec$seasonal
autoplot(TS_Giocattoli_dec)
write.xlsx(TS_Alimentare_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Alimentare', append = FALSE)
Abbigliamento_vs_Alimentare<-(TS_Abbigliamento_dec$trend) - (TS_Alimentare_dec$trend)
autoplot(Abbigliamento_vs_Alimentare)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
Calzature_vs_Alimentare<-TS_Calzature_dec$trend-TS_Alimentare_dec$trend
autoplot(Calzature_vs_Alimentare)
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Calzature', append = TRUE)
Elettrodomestici_vs_Alimentare<-TS_Elettrodomestici_dec$trend-TS_Alimentare_dec$trend
autoplot(Elettrodomestici_vs_Alimentare)
write.xlsx(TS_Elettrodomestici_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Elettrodomestici', append = TRUE)
Fotoottica_vs_Alimentare<-TS_Fotoottica_dec$trend-TS_Alimentare_dec$trend
autoplot(Fotoottica_vs_Alimentare)
write.xlsx(TS_Fotoottica_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Fotoottica', append = TRUE)
Casalinghi_vs_Alimentare<-TS_Casalinghi_dec$trend-TS_Alimentare_dec$trend
autoplot(Casalinghi_vs_Alimentare)
write.xlsx(TS_Casalinghi_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Casalinghi', append = TRUE)
Utilenseria_vs_Alimentare<-TS_Utilenseria_dec$trend-TS_Alimentare_dec$trend
autoplot(Utilenseria_vs_Alimentare)
write.xlsx(TS_Utilenseria_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Utilenseria', append = TRUE)
Giocattoli_vs_Alimentare<-TS_Giocattoli_dec$trend-TS_Alimentare_dec$trend
autoplot(Giocattoli_vs_Alimentare)
write.xlsx(TS_Giocattoli_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Giocattoli', append = FALSE)
write.xlsx(TS_Alimentare_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Alimentare', append = FALSE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
View(TS_Alimentare_dec)
TS_Alimentare_dec[["x"]]
View(TS_Abbigliamento_dec)
TS_Abbigliamento_dec[["x"]]
View(TS_Abbigliamento_dec)
TS_Abbigliamento_dec[["trend"]]
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
View(TS_Abbigliamento_dec)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Elettrodomestici_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Elettrodomestici', append = TRUE)
write.xlsx(TS_Elettrodomestici_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Elettrodomestici', append = TRUE)
write.xlsx(TS_Fotoottica_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Fotoottica', append = TRUE)
write.xlsx(TS_Casalinghi_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Casalinghi', append = TRUE)
write.xlsx(TS_Utilenseria_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Utilenseria', append = TRUE)
write.xlsx(TS_Utilenseria_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Utilenseria', append = TRUE)
write.xlsx(TS_Casalinghi_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Casalinghi', append = TRUE)
write.xlsx(TS_Giocattoli_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Giocattoli', append = FALSE)
write.xlsx(TS_Giocattoli_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Giocattoli', append = FALSE)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
Data2 <- read_excel("Dati_destagionalizzati_2016.xlsx")
Controllo_abbigliamento<-lm(Data$Abbigliamento[1:19]-Data$Alimentari[1:19]~Data$Time[1:19])
summary(Controllo_abbigliamento)
reg22<-lm(Data2$Abbigliamento-Data2$Alimentari~Data2$Time+Data2$T1+Data2$T2+Data2$T3)
summary(reg22)
Data <- read_excel("Dati_destagionalizzati.xlsx")
Data2 <- read_excel("Dati_destagionalizzati_2016.xlsx")
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
Data2 <- read_excel("Dati_destagionalizzati_FULL_2016.xlsx")
reg22<-lm(Data2$Abbigliamento-Data2$Alimentari~Data2$Time+Data2$T1+Data2$T2+Data2$T3)
summary(reg22)
reg2<-lm(Data$Abbigliamento-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg2)
reg2<-lm(Data$Abbigliamento-Data$Alimentari~Data$Time+Data$T1+Data$T2+Data$T3)
summary(reg2)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati.xlsx")
Data2 <- read_excel("Dati_destagionalizzati_FULL_2016.xlsx")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Abbigliamento),color = "blue")+
labs(title="Abbigliamento")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Calzature),color = "darkgreen")+
labs(title="Calzature")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Abbigliamento),color = "blue")+
labs(title="Abbigliamento")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Elettrodomestici),color = "orange")+
labs(title="Elettrodomestici")
ggplot(data=2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Casalinghi),color = "cyan")+
labs(title="Casalinghi")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Casalinghi),color = "cyan")+
labs(title="Casalinghi")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Utilenseria),color = "darkcyan")+
labs(title="Utilenseria")
ggplot(data=Data2,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Giocattoli),color = "yellow")+
labs(title="Giocattoli")
library(readxl)
library(xlsx)
library(fpp)
library(ggplot2)
library(zoo)
library(readxl)
library(xlsx)
library(fpp)
library(ggplot2)
library(zoo)
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
View(TS_Abbigliamento_dec)
TS_Abbigliamento_dec[["trend"]]
TS_Abbigliamento_dec[["random"]]
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$random[42:59]=0
TS_Abbigliamento_dec$random
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[30:48]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
TS_Abbigliamento = ts(Destagionalizzazione$`abbigliamento e pellicce`,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[32:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[42:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Calzature', append = TRUE)
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Calzature', append = TRUE)
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
Destagionalizzazione <- read_excel("Destagionalizzazione_2016.xlsx")
View(Destagionalizzazione)
TS_Abbigliamento = ts(Destagionalizzazione$Abbigliamento,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
Abbigliamento_vs_Alimentare<-(TS_Abbigliamento_dec$trend) - (TS_Alimentare_dec$trend)
autoplot(Abbigliamento_vs_Alimentare)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
Abbigliamento_vs_Alimentare<-(TS_Abbigliamento_dec$trend) - (TS_Alimentare_dec$trend)
autoplot(Abbigliamento_vs_Alimentare)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
Abbigliamento_vs_Alimentare<-(TS_Abbigliamento_dec$trend) - (TS_Alimentare_dec$trend)
autoplot(Abbigliamento_vs_Alimentare)
write.xlsx(TS_Abbigliamento_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Abbigliamento', append = TRUE)
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Calzature', append = TRUE)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[42:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016.xlsx",sheetName='Calzature', append = TRUE)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[42:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Abbigliamento = ts(Destagionalizzazione$Abbigliamento,frequency = 12)
TS_Abbigliamento_dec<-decompose(TS_Abbigliamento,type="additive")
#TS_Abbigliamento_dec$trend[30:48]=TS_Abbigliamento_dec$trend[30:48]+TS_Abbigliamento_dec$random[30:48]
TS_Abbigliamento_dec$random[42:60]=0
TS_Abbigliamento_dec$trend=TS_Abbigliamento_dec$x-TS_Abbigliamento_dec$random-TS_Abbigliamento_dec$seasonal
autoplot(TS_Abbigliamento_dec)
TS_Calzature = ts(Destagionalizzazione$Calzature,frequency = 12)
TS_Calzature_dec<-decompose(TS_Calzature,type="additive")
#TS_Calzature_dec$trend[30:48]=TS_Calzature_dec$trend[30:48]+TS_Calzature_dec$random[30:48]
TS_Calzature_dec$random[42:60]=0
TS_Calzature_dec$trend=TS_Calzature_dec$x-TS_Calzature_dec$random-TS_Calzature_dec$seasonal
autoplot(TS_Calzature_dec$trend)+ geom_line(aes(y=TS_Alimentare_dec$trend))
autoplot(TS_Calzature_dec)
TS_Calzature_dec$trend
write.xlsx(TS_Calzature_dec$trend, file = "Vendite_destag_outcome_2016x.xlsx",sheetName='Calzature', append = TRUE)
library(readxl)
Dati_Abbigliamento <- read_excel("Dati_destagionalizzati_DID.xlsx", sheet = "Abbigliamento")
Dati_Abbigliamento_phantom <- read_excel("Dati_destagionalizzati_DID_phantom.xlsx", sheet = "Abbigliamento")
Abbigliamento <-lm(Outcome ~  C + T1 + T2+T3 + C*T1 +C*T2+C*T3, data = Dati_Abbigliamento )
summary(Abbigliamento)
library(readxl)
library(ggplot2)
Data <- read_excel("Dati_destagionalizzati_FULL.xlsx")
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Abbigliamento),color = "blue")+
geom_vline(xintercept = -4, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = -3, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = -2, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = -1, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Abbigliamento),color = "blue")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Elettrodomestici),color = "orange")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Elettrodomestici),color = "orange")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Calzature),color = "darkgreen")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,a
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Elettrodomestici),color = "orange")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Elettrodomestici),color = "orange")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Mobili),color = "purple")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Fotoottica),color = "darkblue")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Casalinghi),color = "cyan")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Utilenseria),color = "darkcyan")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Giocattoli),color = "Plum")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Utilenseria),color = "darkcyan")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Casalinghi),color = "cyan")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
ggplot(data=Data,aes(x=Time,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Time,y=Casalinghi),color = "purple")+
geom_vline(xintercept = 1, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 2, linetype="dashed", color = "red", size=1)+
geom_vline(xintercept = 3, linetype="dashed", color = "orange", size=1)+
geom_vline(xintercept = 4, linetype="dashed", color = "darkgreen", size=1)+theme_bw()+ labs(y = "Selling value")+ labs(x = "Time (months)")+theme_bw(base_size = 18)
