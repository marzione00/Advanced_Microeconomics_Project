source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(DID_selling_matrix)
DID_selling_matrix[,1:4]
DID_selling_matrix[1:4,]
type(DID_selling_matrix)
DID_selling_matrix
typeof(DID_selling_matrix)
DID_selling_matrix <- data.frame(read_excel("Risultati/DID_selling_matrix.xlsx"))
View(DID_selling_matrix)
typeof(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), nrow=length(l), byrow=TRUE)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), nrow=length(l), byrow=TRUE))
#save(DID_selling_matrix,file="DID_selling_matrix.rda")
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), nrow=length(DID_selling_matrix )), byrow=TRUE))
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), nrow=length(DID_selling_matrix ), byrow=TRUE))
#save(DID_selling_matrix,file="DID_selling_matrix.rda")
View(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), nrow=length(DID_selling_matrix ), bycolumn=TRUE))
#save(DID_selling_matrix,file="DID_selling_matrix.rda")
View(DID_selling_matrix)
typeof(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
DID_selling_matrix <-data.frame(matrix(unlist(DID_selling_matrix ), ncolumn=length(DID_selling_matrix ), bycolumn=TRUE))
#save(DID_selling_matrix,file="DID_selling_matrix.rda")
load("DID_selling_matrix.rda")
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
View(DID_selling_matrix)
typeof(DID_selling_matrix)
DID_selling_matrix$High
View(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
load("DID_selling_matrix.rda")
Selling_effect$Type <- DID_selling_matrix$Type
selling_effect<-data.frame(matrix(ncol = 7,nrow=4))
Selling_effect$Type <- DID_selling_matrix$Type
View(selling_effect)
selling_effect<-data.frame(matrix(ncol = 4,nrow=7))
Selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Type <- DID_selling_matrix$Type
View(selling_effect)
selling_effect$Type <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
View(selling_effect)
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
View(selling_effect)
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
selling_effect$High <- strong_lockdown_weeks
selling_effect$Medium <- medium_lockdown_weeks
View(selling_effect)
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
selling_effect$High <- strong_lockdown_weeks
selling_effect$Medium <- medium_lockdown_weeks
selling_effect$Low <- Low_lockdown_weeks
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
View(DID_selling_matrix_error)
View(DID_selling_matrix)
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
selling_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
selling_effect$High <- strong_lockdown_weeks
selling_effect$Medium <- medium_lockdown_weeks
selling_effect$Low <- soft_lockdown_weeks
View(DID_selling_matrix_error)
View(DID_selling_matrix)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
dt(102.704/2.826,1)
dt(4.446/9.419,1)
dt(4.446/9.419,64)
4.446/9.419
dt(4.446/9.419,64,lower=FALSE)
pt(4.446/9.419,64,lower=FALSE)
pt(4.446/9.419,64,lower=TRUE)
pt(4.446/9.419,1,lower=TRUE)
pt(6.568/5.466   ,1,lower=TRUE)
pt(6.568/5.466   ,64,lower=TRUE)
1-pt(6.568/5.466   ,1,lower=TRUE)
1-pt(1.202,1,lower=TRUE)
1-pt(1.202,64,lower=TRUE)
1-pt(0.472,1,lower=TRUE)
1-pt(0.472,1)
1-pt(0.472,1,lower=FALSE)
1-pt(0.472,1)
1-dt(0.472,1)
dt(0.472,1)
1-dt(0.472,1)
1-dt(0.472,64)
2 * pt(abs(0.472), 64, lower.tail = FALSE)
2 * pt(abs(0.472), 1, lower.tail = FALSE)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(DID_selling_matrix_error)
View(selling_effect)
selling_effect$P_value
selling_effect$P_value[4]
selling_effect$P_value[1]
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
score<-0
#rate_infection_threshold<-0.000001
rate_infection_threshold<-0.000007
library(deSolve)
library(optimization)
library(tidyverse)
library(MASS)
library(ggplot2)
buffer<-data.frame(matrix(ncol = 5))
soft_lockdown_weeks<- 0
medium_lockdown_weeks<- 0
strong_lockdown_weeks<- 0
no_lockdown_weeks<- 0
lockdown_weeks<-0
out<-data.frame(matrix(ncol = 5))
selling_effect<-data.frame(matrix(ncol = 0,nrow=7))
colnames(buffer) <- c("time", "S","I","R","D")
pop_tot<-60000000
delta_inf<-0
#k<-c(1.5,1.5,1.5)
#k<-c(1,1,1)
k<-c(0.25,0.25,0.25)
#rate_infection_threshold<-0.000001
rate_infection_threshold<-0.000007
score<-0
p_vector<-numeric(400)
R_t<-numeric(52)
#DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
#as.data.frame(DID_selling_matrix)
#save(DID_selling_matrix,file="DID_selling_matrix.rda")
load("DID_selling_matrix.rda")
#DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
#as.data.frame(DID_selling_matrix_error)
#save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
load("DID_selling_matrix_error.rda")
#p_vector <- runif(400, 0.000, 1.000)
#save(p_vector,file="p_vector.rda")
load("p_vector.rda")
closed.sir.model <- function (t, x, params) {
## first extract the state variables
S <- x[1]
I <- x[2]
R <- x[3]
D <- x[4]
## now extract the parameters
beta <- params["beta"]
gamma <- params["gamma"]
delta <- params["delta"]
N <- S+I+R
## now code the model equations
dSdt <- -beta*S*I/N
dIdt <- beta*S*I/N-gamma*I-delta*I
dRdt <- gamma*I
dDdt <- delta*I
## combine results into a single vector
dxdt <- c(dSdt,dIdt,dRdt,dDdt)
## return result as a list!
list(dxdt)
#  L <- ifelse(I=> 10000, 0.5, 1)
}
parms <- c(beta=0.5,gamma=0.14,delta=0.01)
xstart <- c(S=pop_tot
,I=1,R=0,D=0)
for(i in 0:52) {
times <- seq(from=0+i*7,to=7+i*7,by=1)
ode(
func=closed.sir.model,
y=xstart,
times=times,
parms=parms
) %>%
as.data.frame() -> out
peppo<-as.data.frame(t(as.matrix(data.frame(Reduce(rbind,out)))))
colnames(peppo) <- c("time", "S","I","R","D")
peppo<-peppo[-8,]
buffer<-rbind(buffer,peppo)
#print(out$S)
xstart <- c(S=out$S[8],I=out$I[8],R=out$R[8],D=out$D[8])
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold && p_vector[i+1] >= 0.5*k[1]) {
parms <- c(beta=0.5*0.7,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("-LOW")
}
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold*10 & p_vector[i+1] >= 0.5*k[2]) {
parms <- c(beta=0.5*0.25,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("-MEDIUM")
}
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold*50 & p_vector[i+1] >= 0.5*k[3]) {
parms <- c(beta=0.5*0.025,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("HIGH")
}
if(buffer[(i+1)*7,]$I/pop_tot < rate_infection_threshold*0.5 & p_vector[i+1] >= 0.5*k[1] ) {
parms <- c(beta=0.5,gamma=0.14,delta=0.01)
}
if(parms == c(beta=0.5)) {
no_lockdown_weeks <- no_lockdown_weeks +1
R_t[i]=0.4/0.14
print("NO RESTRICTION")
}
if(parms == c(beta=0.5*0.7)) {
soft_lockdown_weeks <- soft_lockdown_weeks +1
R_t[i]=0.4*0.5/0.14
print("SOFT")
}
if(parms == c(beta=0.5*0.25)) {
medium_lockdown_weeks <- medium_lockdown_weeks +1
R_t[i]=0.4*0.1/0.14
print("MEDIUM")
}
if(parms == c(beta=0.5*0.025)) {
R_t[i]=0.4*0.05/0.14
strong_lockdown_weeks <- strong_lockdown_weeks +1
print("HIGH")
}
if(parms != c(beta=0.5)) {
lockdown_weeks <- lockdown_weeks +1
}
if (i>0) {
delta_inf<-buffer[(i+1)*7,]$I-buffer[(i)*7,]$I
}
}
soft_lockdown_weeks
medium_lockdown_weeks
strong_lockdown_weeks
lockdown_weeks
buffer$D[370]
print("Costo morti kEUR")
buffer$D[370]*300
print("Costo ricoveri kEUR")
buffer$R[370]*28.180
score <- soft_lockdown_weeks+(1/7)+medium_lockdown_weeks*(1/0.25)+strong_lockdown_weeks*(1/0.025)
score
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
selling_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
selling_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
selling_effect$High <- strong_lockdown_weeks
selling_effect$Medium <- medium_lockdown_weeks
selling_effect$Low <- soft_lockdown_weeks
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
#  scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
library(readxl)
#Vendite
Vendite_READY <- read_excel("Progetto Micro/Vendite_READY.xlsx")
Vendite_READY_test <- read_excel("Progetto Micro/Vendite_READY_test.xlsx")
install.packages("ggplot2")
library(ggplot2)
Vendite_READY$delta<-Vendite_READY$Alimentari-Vendite_READY$NAlimentare
ggplot(data=Vendite_READY,aes(x=Data,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Data,y=NAlimentare),color = "blue")+
geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Data,y=delta),color = "green")
did <-lm(Alimentari ~  C + Time + Time2+Time3 + C*Time +C*Time2+C*Time3, data = Vendite_READY_test)
summary(did)
#plot(did)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
View(DID_selling_matrix)
warnings()
ggplot(DID_selling_matrix, aes(x=Type, y=High, group=supp, color=supp))
ggplot(DID_selling_matrix, aes(x=Type, y=High))
View(DID_selling_matrix_error)
View(selling_effect)
ggplot(selling_effect, aes(x=Type, y=High)) +
geom_pointrange(aes(ymin=effect-effect_error, ymax=ymin=effect+effect_error))
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=effect-effect_error, ymax=ymin=effect+effect_error))
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=effect-effect_error, ymax=effect+effect_error))
View(selling_effect)
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect),group=Type, color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect),group=Type, color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect), color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error),color=Type)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(size=18)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18,axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18, axis.text.x = element_text(angle = 90))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip()
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('#999999','#E69F00','#E69F00','#E69F00','#E69F00','#E69F00','#E69F00'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error)) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18,legend.position = "none") + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
View(DID_selling_matrix)
View(DID_selling_matrix_error)
View(DID_selling_matrix)
View(selling_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(DID_selling_matrix)
View(DID_selling_matrix)
library(deSolve)
library(optimization)
library(tidyverse)
library(MASS)
library(ggplot2)
buffer<-data.frame(matrix(ncol = 5))
soft_lockdown_weeks<- 0
medium_lockdown_weeks<- 0
strong_lockdown_weeks<- 0
no_lockdown_weeks<- 0
lockdown_weeks<-0
out<-data.frame(matrix(ncol = 5))
selling_effect<-data.frame(matrix(ncol = 0,nrow=7))
colnames(buffer) <- c("time", "S","I","R","D")
pop_tot<-60000000
delta_inf<-0
#k<-c(1.5,1.5,1.5)
k<-c(1,1,1)
#k<-c(0.1,0.1,0.1)
#rate_infection_threshold<-0.000001
rate_infection_threshold<-0.000007
score<-0
p_vector<-numeric(400)
R_t<-numeric(52)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
as.data.frame(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
library(readxl)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
View(DID_selling_matrix)
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('blue','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','blue','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','purple','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','violtred','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','violetred','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
load("DID_selling_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
load("DID_selling_matrix_error.rda")
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
DID_selling_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_selling_matrix,file="DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_selling_matrix,file="DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_CIG_matrix,file="DID_CIG_matrix.rda")
#load("DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
library(readxl)
library(readxl)
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_CIG_matrix,file="DID_CIG_matrix.rda")
load("DID_CIG_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
load("DID_CIG_matrix.rda")
DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
as.data.frame(DID_CIG_matrix_error)
save(DID_CIG_error,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
as.data.frame(DID_CIG_matrix_error)
save(DID_CIG_error,file="DID_CIG_matrix_error.rda")
save(DID_CIG_matrix_error ,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
CIG_effect<-data.frame(matrix(ncol = 0,nrow=7))
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
library(ggplot2)
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
View(CIG_effect)
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(CIG_effect)
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(CIG_effect)
load("DID_CIG_matrix.rda")
#DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
#as.data.frame(DID_CIG_matrix_error)
#save(DID_CIG_matrix_error ,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
#p_vector <- runif(400, 0.000, 1.000)
#save(p_vector,file="p_vector.rda")
load("p_vector.rda")
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(DID_CIG_matrix)
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect<-data.frame(matrix(ncol = 0,nrow=7))
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
CIG_effect$Type <- DID_CIG_matrix$Type
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(CIG_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
View(CIG_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks+DID_CIG_matrix$Low*low_lockdown_weeks
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')+theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
