#save(p_vector,file="p_vector.rda")
load("p_vector.rda")
closed.sir.model <- function (t, x, params) {
## first extract the state variables
S <- x[1]
I <- x[2]
R <- x[3]
D <- x[4]
## now extract the parameters
beta <- params["beta"]
gamma <- params["gamma"]
delta <- params["delta"]
N <- S+I+R
## now code the model equations
dSdt <- -beta*S*I/N
dIdt <- beta*S*I/N-gamma*I-delta*I
dRdt <- gamma*I
dDdt <- delta*I
## combine results into a single vector
dxdt <- c(dSdt,dIdt,dRdt,dDdt)
## return result as a list!
list(dxdt)
#  L <- ifelse(I=> 10000, 0.5, 1)
}
parms <- c(beta=0.5,gamma=0.14,delta=0.01)
xstart <- c(S=pop_tot
,I=1,R=0,D=0)
for(i in 0:52) {
times <- seq(from=0+i*7,to=7+i*7,by=1)
ode(
func=closed.sir.model,
y=xstart,
times=times,
parms=parms
) %>%
as.data.frame() -> out
peppo<-as.data.frame(t(as.matrix(data.frame(Reduce(rbind,out)))))
colnames(peppo) <- c("time", "S","I","R","D")
peppo<-peppo[-8,]
buffer<-rbind(buffer,peppo)
#print(out$S)
xstart <- c(S=out$S[8],I=out$I[8],R=out$R[8],D=out$D[8])
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold && p_vector[i+1] >= 0.5*k[1]) {
parms <- c(beta=0.5*0.7,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("-LOW")
}
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold*10 & p_vector[i+1] >= 0.5*k[2]) {
parms <- c(beta=0.5*0.25,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("-MEDIUM")
}
if(buffer[(i+1)*7,]$I/pop_tot > rate_infection_threshold*50 & p_vector[i+1] >= 0.5*k[3]) {
parms <- c(beta=0.5*0.025,gamma=0.14,delta=0.01)
#  print(buffer[(i+1)*7,]$time)
#  print(buffer[(i+1)*7,]$I)
#  print("HIGH")
}
if(buffer[(i+1)*7,]$I/pop_tot < rate_infection_threshold*0.5 & p_vector[i+1] >= 0.5*k[1] ) {
parms <- c(beta=0.5,gamma=0.14,delta=0.01)
}
if(parms == c(beta=0.5)) {
no_lockdown_weeks <- no_lockdown_weeks +1
R_t[i]=0.4/0.14
print("NO RESTRICTION")
}
if(parms == c(beta=0.5*0.7)) {
soft_lockdown_weeks <- soft_lockdown_weeks +1
R_t[i]=0.4*0.5/0.14
print("SOFT")
}
if(parms == c(beta=0.5*0.25)) {
medium_lockdown_weeks <- medium_lockdown_weeks +1
R_t[i]=0.4*0.1/0.14
print("MEDIUM")
}
if(parms == c(beta=0.5*0.025)) {
R_t[i]=0.4*0.05/0.14
strong_lockdown_weeks <- strong_lockdown_weeks +1
print("HIGH")
}
if(parms != c(beta=0.5)) {
lockdown_weeks <- lockdown_weeks +1
}
if (i>0) {
delta_inf<-buffer[(i+1)*7,]$I-buffer[(i)*7,]$I
}
}
soft_lockdown_weeks
medium_lockdown_weeks
strong_lockdown_weeks
lockdown_weeks
buffer$D[370]
print("Costo morti kEUR")
buffer$D[370]*300
print("Costo ricoveri kEUR")
buffer$R[370]*28.180
score <- soft_lockdown_weeks+(1/7)+medium_lockdown_weeks*(1/0.25)+strong_lockdown_weeks*(1/0.025)
score
selling_effect$Type <- DID_selling_matrix$Type
selling_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
selling_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
selling_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
selling_effect$High <- strong_lockdown_weeks
selling_effect$Medium <- medium_lockdown_weeks
selling_effect$Low <- soft_lockdown_weeks
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
#  scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')
source('~/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
library(readxl)
#Vendite
Vendite_READY <- read_excel("Progetto Micro/Vendite_READY.xlsx")
Vendite_READY_test <- read_excel("Progetto Micro/Vendite_READY_test.xlsx")
install.packages("ggplot2")
library(ggplot2)
Vendite_READY$delta<-Vendite_READY$Alimentari-Vendite_READY$NAlimentare
ggplot(data=Vendite_READY,aes(x=Data,y=Alimentari))+geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Data,y=NAlimentare),color = "blue")+
geom_line(size=2,color = "red")+geom_line(size=2,aes(x=Data,y=delta),color = "green")
did <-lm(Alimentari ~  C + Time + Time2+Time3 + C*Time +C*Time2+C*Time3, data = Vendite_READY_test)
summary(did)
#plot(did)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(selling_effect)
View(DID_selling_matrix)
warnings()
ggplot(DID_selling_matrix, aes(x=Type, y=High, group=supp, color=supp))
ggplot(DID_selling_matrix, aes(x=Type, y=High))
View(DID_selling_matrix_error)
View(selling_effect)
ggplot(selling_effect, aes(x=Type, y=High)) +
geom_pointrange(aes(ymin=effect-effect_error, ymax=ymin=effect+effect_error))
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=effect-effect_error, ymax=ymin=effect+effect_error))
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=effect-effect_error, ymax=effect+effect_error))
View(selling_effect)
ggplot(selling_effect, aes(x=Type, y=High)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect),group=Type, color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect),group=Type, color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))
ggplot(selling_effect, aes(x=Type, y=Effect), color=Type) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error),color=Type)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(size=18)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18,axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18, axis.text.x = element_text(angle = 90))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip()
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('#999999','#E69F00','#E69F00','#E69F00','#E69F00','#E69F00','#E69F00'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error)) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18,legend.position = "none") + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('red','red','red','red','red','red','red'))
View(DID_selling_matrix)
View(DID_selling_matrix_error)
View(DID_selling_matrix)
View(selling_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(DID_selling_matrix)
View(DID_selling_matrix)
library(deSolve)
library(optimization)
library(tidyverse)
library(MASS)
library(ggplot2)
buffer<-data.frame(matrix(ncol = 5))
soft_lockdown_weeks<- 0
medium_lockdown_weeks<- 0
strong_lockdown_weeks<- 0
no_lockdown_weeks<- 0
lockdown_weeks<-0
out<-data.frame(matrix(ncol = 5))
selling_effect<-data.frame(matrix(ncol = 0,nrow=7))
colnames(buffer) <- c("time", "S","I","R","D")
pop_tot<-60000000
delta_inf<-0
#k<-c(1.5,1.5,1.5)
k<-c(1,1,1)
#k<-c(0.1,0.1,0.1)
#rate_infection_threshold<-0.000001
rate_infection_threshold<-0.000007
score<-0
p_vector<-numeric(400)
R_t<-numeric(52)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
as.data.frame(DID_selling_matrix)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
library(readxl)
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
View(DID_selling_matrix)
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('blue','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','red','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','blue','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','red','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','red','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','purple','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','red','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','violtred','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','violetred','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','red','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','red'))
ggplot(selling_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
DID_selling_matrix <- read_excel("Risultati/DID_selling_matrix.xlsx")
as.data.frame(DID_selling_matrix)
save(DID_selling_matrix,file="DID_selling_matrix.rda")
load("DID_selling_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
load("DID_selling_matrix_error.rda")
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
DID_selling_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_selling_matrix,file="DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_selling_matrix,file="DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_CIG_matrix,file="DID_CIG_matrix.rda")
#load("DID_CIG_matrix.rda")
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
library(readxl)
library(readxl)
DID_CIG_matrix <- read_excel("Risultati/DID_CIG_matrix.xlsx")
as.data.frame(DID_CIG_matrix)
save(DID_CIG_matrix,file="DID_CIG_matrix.rda")
load("DID_CIG_matrix.rda")
DID_selling_matrix_error <- read_excel("Risultati/DID_selling_matrix_error.xlsx")
as.data.frame(DID_selling_matrix_error)
save(DID_selling_matrix_error,file="DID_selling_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
load("DID_CIG_matrix.rda")
DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
as.data.frame(DID_CIG_matrix_error)
save(DID_CIG_error,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
as.data.frame(DID_CIG_matrix_error)
save(DID_CIG_error,file="DID_CIG_matrix_error.rda")
save(DID_CIG_matrix_error ,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
CIG_effect<-data.frame(matrix(ncol = 0,nrow=7))
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
library(ggplot2)
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
View(CIG_effect)
CIG_effect$Type <- DID_selling_matrix$Type
CIG_effect$Effect <- DID_selling_matrix$High*strong_lockdown_weeks+DID_selling_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_selling_matrix_error$High*strong_lockdown_weeks+DID_selling_matrix_error$Medium*medium_lockdown_weeks+DID_selling_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(selling_effect$Effect/selling_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(CIG_effect)
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(CIG_effect)
load("DID_CIG_matrix.rda")
#DID_CIG_matrix_error <- read_excel("Risultati/DID_CIG_matrix_error.xlsx")
#as.data.frame(DID_CIG_matrix_error)
#save(DID_CIG_matrix_error ,file="DID_CIG_matrix_error.rda")
load("DID_CIG_matrix_error.rda")
#p_vector <- runif(400, 0.000, 1.000)
#save(p_vector,file="p_vector.rda")
load("p_vector.rda")
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
CIG_effect$Effect_error <- DID_CIG_matrix_error$High*strong_lockdown_weeks+DID_CIG_matrix_error$Medium*medium_lockdown_weeks+DID_CIG_matrix_error$Low*soft_lockdown_weeks
CIG_effect$P_value <- 2 * pt(abs(CIG_effect$Effect/CIG_effect$Effect_error),64,lower.tail = FALSE)
CIG_effect$High <- strong_lockdown_weeks
CIG_effect$Medium <- medium_lockdown_weeks
CIG_effect$Low <- soft_lockdown_weeks
View(DID_CIG_matrix)
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect<-data.frame(matrix(ncol = 0,nrow=7))
CIG_effect$Type <- DID_CIG_matrix$Type
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
CIG_effect$Type <- DID_CIG_matrix$Type
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(CIG_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(CIG_effect, aes(x=Type, y=Effect)) + geom_pointrange(aes(ymin=Effect-Effect_error, ymax=Effect+Effect_error,color = Type))+theme_bw(base_size = 18) + theme(legend.position = "none")+ coord_flip() +scale_color_manual(values=c('green','darkblue','orange','blue','palevioletred1','purple','cyan'))
View(CIG_effect)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
CIG_effect$Effect <- DID_CIG_matrix$High*strong_lockdown_weeks+DID_CIG_matrix$Medium*medium_lockdown_weeks+DID_CIG_matrix$Low*low_lockdown_weeks
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
buffer %>%
gather(variable,value,-time) %>%
ggplot(aes(x=time,y=value,color=variable))+geom_line(size=2)+
scale_y_log10() +
labs(x='time (days)',y='Log number of individuals')+theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
buffer$R[370]
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
buffer$R[370]
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
k<-c(1.1,1.1,1.1)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
k<-c(1,1,1)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
library(readxl)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
View(Phase_transition)
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths, color=variable)) + labs(title="Economics")
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths)) + labs(title="Economics")
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths)) + labs(title="Economics")+ theme_bw()
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths)) + labs(title="Economics")+ theme_bw(base_size = 18)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths)) + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition) + geom_line(aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths),size=2,color = "red") + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition,aes(x=Phase_transition$PM_attitute, y=Phase_transition$Deaths),size=2,color = "red") + geom_line() + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition,aes(x=PM_attitute, y=Deaths),size=2,color = "red") + geom_line() + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition,aes(x=PM_attitute, y=Deaths),size=2,color = "red") + geom_line(color="red") +   geom_point() + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition,aes(x=PM_attitute, y=Deaths),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = "Deaths ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
library(readxl)
library(ggplot2)
Phase_transition <- read_excel("Risultati/Phase_transition.xlsx")
ggplot(Phase_transition,aes(x=PM_attitute, y=Deaths),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = "Death ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
R_t
as.data.frame(R_t)
as.data.frame(R_t)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(R_t)
ggplot(R_t,size=2,color = "red") + geom_line(color="red")
ggplot(R_t,aes(y=R_t),size=2,color = "red") + geom_line(color="red")
R_t$Value<-as.data.frame(R_t)
R_t$Time<-as.data.frame(range(1:52))
R_t$Value<-as.data.frame(R_t)
range(1:52)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(R_t)
R_t$Value<-as.data.frame(R_t)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(R_t)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
View(A)
A<-c(R_t,1:52)
A<-as.data.frame(c(R_t,1:52))
View(A)
A<-as.data.frame(R_t,1:52)
data.frame(df, stringsAsFactors = TRUE)
data.frame(df)
A<-data.frame(R_t)
View(A)
A<-data.frame(1:52)
View(A)
A<-data.frame(R_t)
A$Time<-data.frame(1:52)
View(A)
A$Value<-data.frame(R_t)
A$Time<-data.frame(1:52)
View(A)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
A$Value<-data.frame(R_t)
A$Time<-data.frame(1:52)
A$Value<-as.data.frame(R_t)
A$Time<-data.frame(1:52)
A<-data.frame(1:52)
A$Value<-as.data.frame(R_t)
View(buffer)
View(A)
A
A[X1.52]
A["X1.52]
A["X1.52"]
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red")
View(A)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = "Death ")+ labs(x = "PM attitute")+ theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = " R(t)")+ labs(x = "Weeks")+ theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.25)+theme_bw(base_size = 18)
View(A)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857)+theme_bw(base_size = 18)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "red") + geom_line(color="red") +   geom_point(color="red") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857,linetype="dashed", color = "red", size=0.25)+theme_bw(base_size = 18)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "blue") + geom_line(color="blue") +   geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857,linetype="dashed", color = "red", size=0.25)+theme_bw(base_size = 18)
View(A)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "blue") + geom_line(color="blue") +   geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857,linetype="dashed", color = "red", size=0.5)+geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=1.4285,linetype="dashed", color = "red", size=0.5)+theme_bw(base_size = 18)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "blue") + geom_line(color="blue") +   geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857,linetype="dashed", color = "orange", size=0.5)+geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=1.4285,linetype="dashed", color = "red", size=0.5)+theme_bw(base_size = 18)
View(A)
ggplot(A,aes(y=R_t,x=X1.52),size=2,color = "blue") + geom_line(color="blue") +   geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=0.2857,linetype="dashed", color = "orange", size=0.5)+geom_point(color="blue") + labs(y = " R(t)")+ labs(x = "Weeks")+ geom_hline(yintercept=1.4285,linetype="dashed", color = "red", size=0.5)+ geom_hline(yintercept=0.1428,linetype="dashed", color = "green", size=0.5)+theme_bw(base_size = 18)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
source('~/Documents/GitHub/Advanced_Microeconomics_Project/Project_script_Stochastic.R', echo=TRUE)
library(readxl)
Dati_Abbigliamento <- read_excel("Dati_destagionalizzati_DID.xlsx", sheet = "Abbigliamento")
Dati_Abbigliamento_phantom <- read_excel("Dati_destagionalizzati_DID_phantom.xlsx", sheet = "Abbigliamento")
